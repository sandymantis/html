// HTML should provide your team with a clear, concise understanding of the context, insights, and strategic recommendations from your discussion. Let me know if youâ€™d like further adjustments!
// JavaScript
const table = document.querySelector('member-table');
const detailsCard = document.querySelector('member-details-card');

// When a row is selected in the table
table.addEventListener('select', (e) => {
  const selectedId = Array.from(e.detail.selectedRows)[0]; // Get first selected ID
  const selectedMember = table.data.find(member => member.id === selectedId);
  if (selectedMember) {
    detailsCard.member = selectedMember;
  }
});

// Example member data structure
const memberData = {
  id: 1,
  name: "John Doe",
  email: "john@example.com",
  phone: "+1 (555) 123-4567",
  status: "Active",
  membershipType: "Premium",
  joinDate: "2024-01-15",
  lastActive: "2024-03-29",
  renewalDate: "2025-01-15",
  paymentMethod: "Credit Card",
  monthlyFee: 99.99,
  notes: "Prefers email communication. Interested in group activities."
};

class MemberDetailsCard extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
    this._member = null;
    this.render();
  }

  static get observedAttributes() {
    return ['member-data'];
  }

  get member() {
    return this._member;
  }

  set member(newMember) {
    this._member = newMember;
    this.render();
  }

  attributeChangedCallback(name, oldValue, newValue) {
    if (name === 'member-data') {
      try {
        this._member = JSON.parse(newValue);
        this.render();
      } catch (e) {
        console.error('Invalid member data provided');
      }
    }
  }

  formatDate(date) {
    return new Date(date).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric'
    });
  }

  formatCurrency(amount) {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD'
    }).format(amount);
  }

  getStatusIcon(status) {
    const icons = {
      'Active': `<svg class="status-icon active" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="currentColor" fill="none" stroke-width="2"/>
        <path d="M8 12l3 3 6-6" stroke="currentColor" fill="none" stroke-width="2"/>
      </svg>`,
      'Inactive': `<svg class="status-icon inactive" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="currentColor" fill="none" stroke-width="2"/>
        <line x1="8" y1="8" x2="16" y2="16" stroke="currentColor" stroke-width="2"/>
        <line x1="8" y1="16" x2="16" y2="8" stroke="currentColor" stroke-width="2"/>
      </svg>`
    };
    return icons[status] || '';
  }

  render() {
    const styles = `
      <style>
        :host {
          display: block;
          font-family: system-ui, -apple-system, sans-serif;
        }

        .card {
          background: white;
          border-radius: 0.75rem;
          box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
          overflow: hidden;
          max-width: 400px;
        }

        .header {
          padding: 1.5rem;
          background: #f8fafc;
          border-bottom: 1px solid #e2e8f0;
        }

        .member-basic {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .avatar {
          width: 3.5rem;
          height: 3.5rem;
          background: #e2e8f0;
          border-radius: 9999px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.5rem;
          font-weight: 500;
          color: #475569;
        }

        .name-section {
          flex-grow: 1;
        }

        .name {
          font-size: 1.25rem;
          font-weight: 600;
          color: #1e293b;
          margin: 0;
        }

        .member-id {
          font-size: 0.875rem;
          color: #64748b;
          margin-top: 0.25rem;
        }

        .status-badge {
          display: inline-flex;
          align-items: center;
          gap: 0.375rem;
          padding: 0.375rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.875rem;
          font-weight: 500;
        }

        .status-badge.active {
          background: #dcfce7;
          color: #166534;
        }

        .status-badge.inactive {
          background: #fee2e2;
          color: #991b1b;
        }

        .status-icon {
          width: 1rem;
          height: 1rem;
        }

        .content {
          padding: 1.5rem;
        }

        .section {
          margin-bottom: 1.5rem;
        }

        .section:last-child {
          margin-bottom: 0;
        }

        .section-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: #475569;
          margin: 0 0 0.75rem 0;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .info-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
        }

        .info-item {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .info-label {
          font-size: 0.75rem;
          color: #64748b;
        }

        .info-value {
          font-size: 0.875rem;
          color: #1e293b;
          font-weight: 500;
        }

        .membership-badge {
          display: inline-flex;
          align-items: center;
          gap: 0.375rem;
          padding: 0.375rem 0.75rem;
          border-radius: 9999px;
          font-size: 0.875rem;
          font-weight: 500;
          background: #fef3c7;
          color: #92400e;
        }
      </style>
    `;

    const template = this._member ? `
      <div class="card">
        <div class="header">
          <div class="member-basic">
            <div class="avatar">
              ${this._member.name.split(' ').map(n => n[0]).join('')}
            </div>
            <div class="name-section">
              <h3 class="name">${this._member.name}</h3>
              <div class="member-id">ID: ${this._member.id}</div>
            </div>
          </div>
          <div style="margin-top: 1rem;">
            <span class="status-badge ${this._member.status.toLowerCase()}">
              ${this.getStatusIcon(this._member.status)}
              ${this._member.status}
            </span>
          </div>
        </div>

        <div class="content">
          <div class="section">
            <h4 class="section-title">Contact Information</h4>
            <div class="info-grid">
              <div class="info-item">
                <span class="info-label">Email</span>
                <span class="info-value">${this._member.email}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Phone</span>
                <span class="info-value">${this._member.phone || 'Not provided'}</span>
              </div>
            </div>
          </div>

          <div class="section">
            <h4 class="section-title">Membership Details</h4>
            <div class="info-grid">
              <div class="info-item">
                <span class="info-label">Membership Type</span>
                <span class="membership-badge">${this._member.membershipType}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Join Date</span>
                <span class="info-value">${this.formatDate(this._member.joinDate)}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Last Active</span>
                <span class="info-value">${this.formatDate(this._member.lastActive)}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Renewal Date</span>
                <span class="info-value">${this._member.renewalDate ? this.formatDate(this._member.renewalDate) : 'N/A'}</span>
              </div>
            </div>
          </div>

          <div class="section">
            <h4 class="section-title">Billing Information</h4>
            <div class="info-grid">
              <div class="info-item">
                <span class="info-label">Payment Method</span>
                <span class="info-value">${this._member.paymentMethod || 'Not set'}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Monthly Fee</span>
                <span class="info-value">${this._member.monthlyFee ? this.formatCurrency(this._member.monthlyFee) : 'N/A'}</span>
              </div>
            </div>
          </div>

          ${this._member.notes ? `
            <div class="section">
              <h4 class="section-title">Notes</h4>
              <p style="margin: 0; font-size: 0.875rem; color: #475569;">
                ${this._member.notes}
              </p>
            </div>
          ` : ''}
        </div>
      </div>
    ` : `
      <div class="card">
        <div style="padding: 2rem; text-align: center; color: #64748b;">
          No member selected
        </div>
      </div>
    `;

    this.shadowRoot.innerHTML = styles + template;
  }
}

customElements.define('member-details-card', MemberDetailsCard);
